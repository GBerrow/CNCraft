{% extends "base.html" %}
{% load static %}

{% block extra_title %} - Professional CNC Equipment{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home/index.css' %}">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
  <div class="container-fluid p-0">
    <div class="hero-banner position-relative">
      <img
        src="{% static 'images/hero/hero-cnc-main.jpg' %}"
        alt="Professional CNC Equipment and Manufacturing"
        class="w-100 hero-image"
        style="height: 70vh; object-fit: cover"
      />
      <div
        class="hero-overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center"
        style="background: rgba(0, 0, 0, 0.4)"
      >
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-xl-6">
              <h1 class="display-4 text-white fw-bold mb-4">
                Precision CNC Equipment for Professionals
              </h1>
              <p class="lead text-white mb-4">
                Discover our comprehensive range of high-quality CNC machines,
                tools, and accessories designed to elevate your manufacturing
                capabilities.
              </p>
              <div class="hero-buttons">
                <a href="{% url 'products' %}" class="btn btn-primary btn-lg me-3 mb-2">Shop Now</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- About Section -->
<section id="about" class="py-5 mt-4">
  <div class="container">
    <div class="row align-items-center g-4">
      <div class="col-lg-6">
        <h2 class="h1 mb-4">About CNCraft</h2>
        <p class="lead mb-4">
          CNCraft is your trusted partner in precision manufacturing, providing
          top-tier CNC equipment and solutions to professionals and enthusiasts
          worldwide.
        </p>
        <p class="mb-4">
          With over a decade of experience in the industry, we understand the
          demands of modern manufacturing. Our carefully curated selection of
          CNC machines, cutting tools, and accessories represents the pinnacle
          of engineering excellence.
        </p>
        <p class="mb-4">
          Our mission is to empower creators, manufacturers, and innovators with
          the tools they need to bring their visions to life with uncompromising
          precision and quality.
        </p>
        <div class="row text-center mt-5">
          <div class="col-4">
            <h4 class="text-primary mb-2">10+</h4>
            <small class="text-muted">Years Experience</small>
          </div>
          <div class="col-4">
            <h4 class="text-primary mb-2">500+</h4>
            <small class="text-muted">Happy Clients</small>
          </div>
          <div class="col-4">
            <h4 class="text-primary mb-2">1000+</h4>
            <small class="text-muted">Projects Completed</small>
          </div>
        </div>
      </div>
      <div class="col-lg-6">
        <img
          src="{% static 'images/about/about_section_image.jpg' %}"
          alt="CNC Manufacturing Workshop - Professional Equipment"
          class="img-fluid rounded shadow-sm about-image"
        />
      </div>
    </div>
  </div>
</section>

<!-- Services Section -->
<section id="services" class="py-5 cnc-dark-section">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="h1">Our CNC Services</h2>
      <p class="lead">Comprehensive solutions for all your CNC manufacturing needs</p>
    </div>

    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
      <div class="col">
        <div class="card h-100 border-0 shadow-sm service-card">
          <div class="card-body text-center p-4">
            <div class="service-icon mb-3">
              <img src="{% static 'images/services/cnc_machining.jpg' %}" alt="CNC Machining" class="service-image">
            </div>
            <h5 class="card-title">CNC Machining</h5>
            <p class="card-text">
              Precision CNC machining services for complex components with tight
              tolerances.
            </p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100 border-0 shadow-sm service-card">
          <div class="card-body text-center p-4">
            <div class="service-icon mb-3">
              <img src="{% static 'images/services/tool_&_die_making.jpg' %}" alt="Tool & Die Making" class="service-image">
            </div>
            <h5 class="card-title">Tool & Die Making</h5>
            <p class="card-text">
              Custom tool and die manufacturing for specialized production
              requirements.
            </p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100 border-0 shadow-sm service-card">
          <div class="card-body text-center p-4">
            <div class="service-icon mb-3">
              <img src="{% static 'images/services/cad_cam_design.jpg' %}" alt="CAD/CAM Design" class="service-image">
            </div>
            <h5 class="card-title">CAD/CAM Design</h5>
            <p class="card-text">
              Professional CAD/CAM design services to optimize your
              manufacturing processes.
            </p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100 border-0 shadow-sm service-card">
          <div class="card-body text-center p-4">
            <div class="service-icon mb-3">
              <img src="{% static 'images/services/equipment_maintenance.jpg' %}" alt="Equipment Maintenance" class="service-image">
            </div>
            <h5 class="card-title">Equipment Maintenance</h5>
            <p class="card-text">
              Comprehensive maintenance and repair services to keep your
              equipment running smoothly.
            </p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100 border-0 shadow-sm service-card">
          <div class="card-body text-center p-4">
            <div class="service-icon mb-3">
              <img src="{% static 'images/services/training_&_support.jpg' %}" alt="Training & Support" class="service-image">
            </div>
            <h5 class="card-title">Training & Support</h5>
            <p class="card-text">
              Expert training programs and ongoing technical support for your
              team.
            </p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100 border-0 shadow-sm service-card">
          <div class="card-body text-center p-4">
            <div class="service-icon mb-3">
              <img src="{% static 'images/services/fast_delivery.jpg' %}" alt="Fast Delivery" class="service-image">
            </div>
            <h5 class="card-title">Fast Delivery</h5>
            <p class="card-text">
              Quick turnaround times and reliable shipping to meet your project
              deadlines.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Featured Products Section -->
<section class="py-5 cnc-dark-section">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="h1">Featured Products</h2>
      <p class="lead">Discover our most popular CNC equipment and tools</p>
    </div>

    <div class="row row-cols-1 row-cols-sm-1 row-cols-md-2 row-cols-xl-4 g-4 justify-content-center">
      <!-- Show exactly 4 real products -->
      {% for product in featured_products|slice:":4" %}
      <div class="col">
        <div class="card h-100 border-0 shadow-sm product-card">
          <div class="position-relative">
            <img
              src="{% static product.get_main_image %}"
              alt="{{ product.name }}"
              class="card-img-top"
              style="height: 200px; object-fit: cover;"
            />
            {% if product.is_on_sale %}
            <span class="badge bg-danger position-absolute top-0 end-0 m-2">Sale</span>
            {% endif %}
          </div>
          <div class="card-body d-flex flex-column">
            <h6 class="card-title">{{ product.name }}</h6>
            <p class="card-text text-muted small flex-grow-1">
              {{ product.description|truncatewords:15 }}
            </p>
            <div class="d-flex justify-content-between align-items-center mt-auto">
              <div class="price">
                {% if product.discount_price %}
                <span class="text-danger fw-bold">${{ product.discount_price }}</span>
                <small class="text-muted text-decoration-line-through ms-1">${{ product.price }}</small>
                {% else %}
                <span class="fw-bold">${{ product.price }}</span>
                {% endif %}
              </div>
              <a href="{% url 'product_detail' product.id %}" class="btn btn-primary btn-sm">View</a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="text-center mt-5">
      <a href="{% url 'products' %}" class="btn btn-outline-primary btn-lg">View All Products</a>
    </div>
  </div>
</section>

<!-- Testimonials Section -->
<section class="py-5 cnc-dark-section">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="h1">What Our Customers Say</h2>
      <p class="lead">Real feedback from real customers</p>
    </div>

    <div class="row row-cols-1 row-cols-sm-1 row-cols-md-2 row-cols-xl-4 g-4">
      <div class="col">
        <div class="card border-0 shadow-sm h-100 testimonial-card">
          <div class="card-body p-4 d-flex flex-column">
            <div class="mb-3">
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
            </div>
            <p class="mb-3 flex-grow-1">
              "CNCraft provided us with exceptional CNC equipment that has
              transformed our production capabilities. The quality and precision
              are outstanding."
            </p>
            <div class="d-flex align-items-center mt-auto">
              <img
                src="https://images.unsplash.com/photo-1560250097-0b93528c311a?ixlib=rb-4.0.3&auto=format&fit=crop&w=50&q=80"
                alt="John Smith - Manufacturing Director"
                class="rounded-circle me-3"
                width="50"
                height="50"
              />
              <div>
                <h6 class="mb-0">John Smith</h6>
                <small class="text-muted">Manufacturing Director</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card border-0 shadow-sm h-100 testimonial-card">
          <div class="card-body p-4 d-flex flex-column">
            <div class="mb-3">
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
            </div>
            <p class="mb-3 flex-grow-1">
              "The customer service is incredible, and their technical expertise
              helped us choose the perfect equipment for our needs. Highly
              recommended!"
            </p>
            <div class="d-flex align-items-center mt-auto">
              <img
                src="https://images.unsplash.com/photo-1580489944761-15a19d654956?ixlib=rb-4.0.3&auto=format&fit=crop&w=50&q=80"
                alt="Sarah Johnson - Operations Manager"
                class="rounded-circle me-3"
                width="50"
                height="50"
              />
              <div>
                <h6 class="mb-0">Sarah Johnson</h6>
                <small class="text-muted">Operations Manager</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card border-0 shadow-sm h-100 testimonial-card">
          <div class="card-body p-4 d-flex flex-column">
            <div class="mb-3">
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
            </div>
            <p class="mb-3 flex-grow-1">
              "Fast delivery, competitive pricing, and top-quality products.
              CNCraft has become our go-to supplier for all CNC equipment
              needs."
            </p>
            <div class="d-flex align-items-center mt-auto">
              <img
                src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=50&q=80"
                alt="Mike Chen - Production Engineer"
                class="rounded-circle me-3"
                width="50"
                height="50"
              />
              <div>
                <h6 class="mb-0">Mike Chen</h6>
                <small class="text-muted">Production Engineer</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card border-0 shadow-sm h-100 testimonial-card">
          <div class="card-body p-4 d-flex flex-column">
            <div class="mb-3">
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
              <i class="fas fa-star text-warning"></i>
            </div>
            <p class="mb-3 flex-grow-1">
              "Outstanding quality and exceptional support. CNCraft's equipment
              has significantly improved our manufacturing efficiency and product
              quality."
            </p>
            <div class="d-flex align-items-center mt-auto">
              <img
                src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=50&q=80"
                alt="David Wilson - Quality Manager"
                class="rounded-circle me-3"
                width="50"
                height="50"
              />
              <div>
                <h6 class="mb-0">David Wilson</h6>
                <small class="text-muted">Quality Manager</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Contact Form Section -->
<section id="contact" class="py-5 cnc-dark-section" style="background-color: #343a40 !important;">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="h1" style="color: white !important;">Custom Enquiry</h2>
      <p class="lead" style="color: #e9ecef !important;">Need any quick enquiries? Contact us today and we will get back to you as soon as possible.</p>
      <p class="lead" style="color: #e9ecef !important;"> Please feel free to visit the contact page for more information.</p>
    </div>
    
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card shadow-sm" style="background-color: white !important;">
          <div class="card-body p-4" style="background-color: white !important;">
            <form id="homepage-enquiry-form" method="POST" action="{% url 'homepage_enquiry' %}">
              {% csrf_token %}
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="full_name" class="form-label" style="color: #333333 !important; background: none !important;">Full Name *</label>
                  <input type="text" class="form-control" id="full_name" name="full_name" required 
                         autocomplete="name" style="background-color: white !important; color: #333333 !important;">
                </div>
                <div class="col-md-6 mb-3">
                  <label for="email" class="form-label" style="color: #333333 !important; background: none !important;">Email Address *</label>
                  <input type="email" class="form-control" id="email" name="email" required
                         autocomplete="email" style="background-color: white !important; color: #333333 !important;">
                </div>
              </div>
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="phone" class="form-label" style="color: #333333 !important; background: none !important;">Phone Number</label>
                  <input type="tel" class="form-control" id="phone" name="phone"
                         autocomplete="tel" style="background-color: white !important; color: #333333 !important;">
                </div>
                <div class="col-md-6 mb-3">
                  <label for="enquiry_type" class="form-label" style="color: #333333 !important; background: none !important;">Nature of Enquiry *</label>
                  <select class="form-select" id="enquiry_type" name="enquiry_type" required
                          style="background-color: white !important; color: #333333 !important;">
                    <option value="">Select an option</option>
                    <option value="Services">Services</option>
                    <option value="Products">Products</option>
                    <option value="Careers">Careers</option>
                    <option value="Support">Support</option>
                    <option value="Delivery Times">Delivery Times</option>
                    <option value="Other">Other</option>
                  </select>
                </div>
              </div>

              <div class="mb-3">
                <label for="project_details" class="form-label" style="color: #333333 !important; background: none !important;">Project Details</label>
                <textarea class="form-control" id="project_details" name="project_details" 
                        rows="4"
                        placeholder="Please describe your enquiry..."
                        style="background-color: white !important; color: #333333 !important;"></textarea>
              </div>

              <div class="text-center">
                <button type="submit" class="btn btn-primary btn-lg" id="submit-btn">
                  <i class="fas fa-paper-plane me-2"></i>
                  Send Enquiry
                </button>
              </div>
              
              <!-- Success/Error Message Container -->
              <div id="message-container" class="mt-3" style="display: none;">
                <div id="message-content" class="alert" role="alert" style="position: relative; overflow: hidden;">
                  <div id="message-text"></div>
                  <!-- Progress bar for auto-dismiss -->
                  <div id="progress-bar" style="position: absolute; bottom: 0; left: 0; height: 3px; background: #28a745; width: 100%; animation: shrinkWidth 5s linear;"></div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Clients Section -->
<section id="clients" class="py-5">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="h1">Trusted by Industry Leaders</h2>
      <p class="lead">
        Join hundreds of satisfied customers who trust CNCraft for their
        manufacturing needs
      </p>
    </div>

    <div class="row align-items-center g-4">
      <div class="col-lg-2 col-md-4 col-sm-6 col-6 text-center mb-3">
        {% include 'includes/client_logo.html' with company_name="PrecisionTech" logo_type="tech" %}
      </div>
      <div class="col-lg-2 col-md-4 col-sm-6 col-6 text-center mb-3">
        {% include 'includes/client_logo.html' with company_name="MetalWorks" logo_type="metalworks" %}
      </div>
      <div class="col-lg-2 col-md-4 col-sm-6 col-6 text-center mb-3">
        {% include 'includes/client_logo.html' with company_name="Advanced Mfg" logo_type="advanced" %}
      </div>
      <div class="col-lg-2 col-md-4 col-sm-6 col-6 text-center mb-3">
        {% include 'includes/client_logo.html' with company_name="Industrial CNC" logo_type="industrial" %}
      </div>
      <div class="col-lg-2 col-md-4 col-sm-6 col-6 text-center mb-3">
        {% include 'includes/client_logo.html' with company_name="Precision Eng" logo_type="precision" %}
      </div>
      <div class="col-lg-2 col-md-4 col-sm-6 col-6 text-center mb-3">
        {% include 'includes/client_logo.html' with company_name="CNC Solutions" logo_type="solutions" %}
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block postloadjs %}
<script>
  // Smooth scrolling for anchor links
  document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute("href"));
      if (target) {
        target.scrollIntoView({
          behavior: "smooth",
          block: "start",
        });
      }
    });
  });

  // Add improved hover effects to product cards
  document.querySelectorAll(".product-card").forEach((card) => {
    card.addEventListener("mouseenter", function () {
      this.style.transform = "translateY(-5px)";
      this.style.transition = "transform 0.3s ease";
    });

    card.addEventListener("mouseleave", function () {
      this.style.transform = "translateY(0)";
    });
  });

  // Homepage enquiry form AJAX handling
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('homepage-enquiry-form');
    const submitBtn = document.getElementById('submit-btn');
    const messageContainer = document.getElementById('message-container');
    const messageContent = document.getElementById('message-content');

    if (form) {
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Disable submit button and show loading state
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Sending...';
        
        // Hide any previous messages
        messageContainer.style.display = 'none';
        
        // Get form data
        const formData = new FormData(form);
        
        // Send AJAX request
        fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: {
            'X-Requested-With': 'XMLHttpRequest',
          }
        })
        .then(response => response.json())
        .then(data => {
          // Show message
          messageContainer.style.display = 'block';
          
          if (data.success) {
            messageContent.className = 'alert alert-success';
            document.getElementById('message-text').innerHTML = data.message;
            // Reset form on success
            form.reset();
          } else {
            messageContent.className = 'alert alert-danger';
            document.getElementById('message-text').innerHTML = data.message;
          }
          
          // Ensure progress bar is visible and animating
          const progressBar = document.getElementById('progress-bar');
          progressBar.style.animation = 'none';
          progressBar.offsetHeight; // Trigger reflow
          progressBar.style.animation = 'shrinkWidth 5s linear';
          
          // Scroll to message
          messageContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
          
          // Auto-dismiss message after 5 seconds with progress bar
          setTimeout(() => {
            messageContainer.style.display = 'none';
          }, 5000);
        })
        .catch(error => {
          // Show error message
          messageContainer.style.display = 'block';
          messageContent.className = 'alert alert-danger';
          document.getElementById('message-text').innerHTML = 'Sorry, there was an error sending your message. Please try again or contact us directly.';
          
          // Ensure progress bar is visible and animating
          const progressBar = document.getElementById('progress-bar');
          progressBar.style.animation = 'none';
          progressBar.offsetHeight; // Trigger reflow
          progressBar.style.animation = 'shrinkWidth 5s linear';
          
          messageContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
          
          // Auto-dismiss error message after 5 seconds with progress bar
          setTimeout(() => {
            messageContainer.style.display = 'none';
          }, 5000);
        })
        .finally(() => {
          // Re-enable submit button
          submitBtn.disabled = false;
          submitBtn.innerHTML = '<i class="fas fa-paper-plane me-2"></i>Send Enquiry';
        });
      });
    }
  });
</script>
{% endblock %}

